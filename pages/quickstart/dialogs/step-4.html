---
layout: quickstart
permalink: /quickstart/dialogs/step-4/
---

{% capture markdown %}

# Step 4: Add Create Dialog

In this step we're going to finish our create dialog and have it send data to the server.


### Add attributes to Tweet model
The reason our dialog didn't have any fields in the previous step was because it didn't know what fields to generate.
To fix that open up your `tweet` model and list the attributes that describe the model. In this application, each tweet
has a `text` attribute that is of type `text` (the other supported options are `string`, `number` and `boolean`).

Update your `tweet` model to look like this:

```jsx
module.exports = {
  attributes: {
    text: {
      type: 'text',
      displayName: 'Message',
      placeholder: "What's happening?"
    }
  }
};
```

### Launch Create Dialog
Open up your `CreateButton` component and modify the `onClick` handler to look like this:

{% tabs tab1={"name": "ES5", "id": 101} | tab2={"name": "ES6", "id": 102} | tab3={"name": "ESNext", "id": 103} %}
{% tab id=101, is_active=true %}
```jsx
...
  onClick: function() {
    function createTweet(params) {
      console.log(params);
    }

    lore.dialog.show(function() {
      return lore.dialogs.tweet.create({
        onSubmit: createTweet
      });
    })
  },
...
```
{% endtab %}
{% tab id=102 %}
```jsx
...
  onClick() {
    function createTweet(params) {
      console.log(params);
    }

    lore.dialog.show(function() {
      return lore.dialogs.tweet.create({
        onSubmit: createTweet
      });
    })
  }
...
```
{% endtab %}
{% tab id=103 %}
```jsx
...
  onClick() {
    function createTweet(params) {
      console.log(params);
    }

    lore.dialog.show(function() {
      return lore.dialogs.tweet.create({
        onSubmit: createTweet
      });
    })
  }
...
```
{% endtab %}
{% endtabs %}

This code generates a Create Tweet dialog provides an `onSubmit` data that will receive the data the user enters
when they create a tweet. To see it in action, refresh the page, launch the create dialog, add some text, and when you
submit the data you should see the text being logged in the console.

### Save the Tweet
Now we can launch a dialog and get the user input, but we aren't sending it to the API. Let's fix that.

Instead of logging the user data, we're going to pass it to the `tweet.create` action. Modify the `createTweet`
callback in the `onClick` handler to look like this (you'll also need to import `lodash` at the top of the file):

{% tabs tab1={"name": "ES5", "id": 104} | tab2={"name": "ES6", "id": 105} | tab3={"name": "ESNext", "id": 106} %}
{% tab id=104, is_active=true %}
```jsx
var _ = require('lodash');

...
  onClick: function() {
    function createTweet(params) {
      lore.actions.tweet.create(_.extend(params, {
        userId: 1,
        createdAt: new Date().toISOString()
      }))
    }

    ...
  },
...
```
{% endtab %}
{% tab id=105 %}
```jsx
import _ from 'lodash';

...
  onClick() {
    function createTweet(params) {
      lore.actions.tweet.create(_.extend(params, {
        userId: 1,
        createdAt: new Date().toISOString()
      }))
    }

    ...
  }
...
```
{% endtab %}
{% tab id=106 %}
```jsx
import _ from 'lodash';

...
  onClick() {
    function createTweet(params) {
      lore.actions.tweet.create(_.extend(params, {
        userId: 1,
        createdAt: new Date().toISOString()
      }))
    }

    ...
  }
...
```
{% endtab %}
{% endtabs %}

Now when you submit a tweet, the action will send the data to the API, and your tweet will show up at the bottom of
the list. Try it out!

### What's up with the _.extend call?

Under normal circumstances our action call would only look like this (with no call to `_.extend(...)`):

```js
function createTweet(params) {
  lore.actions.tweet.create(params)
}
```

But because we're currently using a mock API through `json-server` some fields that would normally be created the API
won't exist on the data, and this can break our application code. So for now, we're simply going to create those
server-generated properties on the client-side when we create the data.

Later in the quickstart, we'll switch to a real API and will be able to delete this modification.

### Visual Check-in

If everything went well, your application should now look like this.

<img class="drop-shadow" src="/assets/images/quickstart/dialogs/step-4.png">

## Code Changes

Below is a list of files modified during this step, as well as a visual diff to show you what was added or removed
between this step and the last one.

### src/components/CreateButton.js

{% tabs tab1={"name": "Diff", "id": 1} | tab2={"name": "Source", "id": 2} %}
{% tab id=1, is_active=true %}
![config](/assets/images/quickstart/diffs/dialogs/step-4-create-button.png)
{% endtab %}
{% tab id=2 %}
```jsx
var React = require('react');

module.exports = React.createClass({
  displayName: 'CreateButton',

  getStyles: function() {
    return {
      createButton: {
        position: 'absolute',
        top: '25px',
        right: '15px',
        zIndex: 1000,
        borderRadius: '100px',
        outline: 'none'
      }
    }
  },

  onClick: function() {
    function createTweet(params) {
      lore.actions.tweet.create(params);
    }

    lore.dialog.show(function() {
      return lore.dialogs.tweet.create({
        onSubmit: createTweet
      });
    })
  },

  render: function () {
    var styles = this.getStyles();

    return (
      <button
        type="button"
        className="btn btn-primary btn-lg"
        style={styles.createButton}
        onClick={this.onClick}>
        +
      </button>
    );
  }
});
```
{% endtab %}
{% endtabs %}

## Next Steps

Next we're going to [create a way to edit tweets](../step-5/).

{% endcapture %}
{{ markdown | markdownify }}
